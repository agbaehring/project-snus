#include <Wire.h>
#include <Zumo32U4.h>
#include <Zumo32U4OLED.h>

Zumo32U4LineSensors lineSensors;
Zumo32U4OLED display;
Zumo32U4ButtonA buttonA;

unsigned int lineSensorValues[5];

void setup() {
  Serial.begin(9600);
  lineSensors.initFiveSensors();

  display.setLayout21x8();
  
  display.clear();
  display.print(F("Line"));
  delay(1000);
  
  // Calibration
  display.clear();
  display.print(F("Calib"));
  display.gotoXY(0, 1);
  display.print(F("Sweep!"));
  
  delay(1000);
  
  for (uint16_t i = 0; i < 100; i++) {
    lineSensors.calibrate();
    delay(20);
  }
  
  display.clear();
  display.print(F("Ready!"));
  delay(500);
  display.clear();
}

void loop() {
  lineSensors.read(lineSensorValues, QTR_EMITTERS_ON);
  
  // Display on OLED - showing 3 main sensors (indices 1,2,3)
  display.clear();
  display.gotoXY(0, 0);
  display.print(lineSensorValues[1]);
  display.print(F(" "));
  display.gotoXY(0, 1);
  display.print(lineSensorValues[2]);
  display.print(F(" "));
  display.gotoXY(0, 2);
  display.print(lineSensorValues[3]);
  display.print(F(" "));
  display.gotoXY(0, 3);
  display.print(lineSensorValues[4]);
  display.print(F(" "));
  display.gotoXY(0, 4);
  display.print(lineSensorValues[5]);
  display.print(F(" "));
  
  display.gotoXY(0, 1);
  display.print(lineSensorValues[3]);
  
  // Print all values to Serial Monitor
  Serial.print(lineSensorValues[0]);
  Serial.print(" ");
  Serial.print(lineSensorValues[1]);
  Serial.print(" ");
  Serial.print(lineSensorValues[2]);
  Serial.print(" ");
  Serial.print(lineSensorValues[3]);
  Serial.print(" ");
  Serial.println(lineSensorValues[4]);
  
  delay(100);
}
